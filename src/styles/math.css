/* Math equation styling with KaTeX */

/* Display math (block equations) */
.katex-display {
  margin: 2em 0;
  overflow-x: auto;
  overflow-y: hidden;
  padding: 0.5rem 0;
  text-align: center;
}

.katex-display > .katex {
  display: inline-block;
  white-space: nowrap;
  max-width: 100%;
  text-align: left;
}

/* Inline math */
.katex {
  font-size: 1.05em;
  color: var(--text);
}

/* Improve readability on smaller screens */
@media (max-width: 768px) {
  .katex-display {
    margin: 1.5em 0;
    font-size: 0.95em;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .katex-display::-webkit-scrollbar {
    height: 0.375rem;
  }

  .katex-display::-webkit-scrollbar-track {
    background: var(--code-scrollbar-track);
    border-radius: 0.25rem;
  }

  .katex-display::-webkit-scrollbar-thumb {
    background: var(--code-scrollbar-thumb);
    border-radius: 0.25rem;
  }

  .katex-display {
    scrollbar-width: thin;
    scrollbar-color: var(--code-scrollbar-thumb) var(--code-scrollbar-track);
  }
}

@media (max-width: 480px) {
  .katex-display {
    font-size: 0.875em;
    margin: 1.25em -0.5rem;
    padding: 0.5rem;
  }

  .katex {
    font-size: 1em;
  }
}

/* Math in lists and blockquotes */
li .katex-display,
blockquote .katex-display {
  margin: 1em 0;
}

/* Ensure proper spacing */
p + .katex-display {
  margin-top: 1.5em;
}

.katex-display + p {
  margin-top: 1.5em;
}

/* KaTeX error styling */
.katex-error {
  color: var(--error-text);
  background-color: var(--error-bg);
  padding: 0.25rem 0.5rem;
  border-radius: 0.25rem;
  border: 1px solid var(--error-border);
}

/* Math number styling */
.katex .mord.text {
  color: var(--text);
}

/* Better color contrast for math symbols */
.katex .mrel,
.katex .mbin,
.katex .mop {
  color: var(--math-operator);
}

.katex .mopen,
.katex .mclose {
  color: var(--math-bracket);
}

/* Improve spacing around fractions */
.katex .mfrac {
  margin: 0 0.2em;
}

/* Ensure math doesn't break page layout */
.katex-display {
  max-width: 100%;
  box-sizing: border-box;
}

/* High contrast mode */
@media (prefers-contrast: high) {
  .katex {
    font-weight: 500;
  }

  .katex-display {
    border: 1px solid var(--divider);
    padding: 1rem;
    border-radius: 0.5rem;
  }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .katex-display {
    scroll-behavior: auto;
  }
}
